{
  "Id": 11,
  "Name": "Ominous shadow figure",
  "UserPrompt": "Make a shadow figure that very slowly teleports and follows you, when you look at it, it should start to hurt you, aswell as slightly darken the screen and do spooky effects.\n",
  "ExecutionCode": "local ply = Entity(1)\nlocal shadow = ents.Create(\u0022prop_dynamic\u0022)\nshadow:SetModel(\u0022models/player/corpse1.mdl\u0022)\nshadow:SetPos(ply:GetPos() \u002B ply:GetForward() * 500 \u002B Vector(0,0,20))\nshadow:Spawn()\nshadow:SetColor(Color(0,0,0,255))\nshadow:SetRenderMode(RENDERMODE_TRANSCOLOR)\nshadow:SetMaterial(\u0022models/debug/debugwhite\u0022)\n\n_G.ShadowFigure = shadow\n_G.ShadowActive = true\n\ntimer.Create(\u0022ShadowFollow\u0022, math.Rand(3, 6), 0, function()\n    if not _G.ShadowActive or not IsValid(_G.ShadowFigure) or not IsValid(ply) then return end\n    \n    local angles = Angle(0, math.random(0, 360), 0)\n    local dist = math.random(300, 600)\n    local newPos = ply:GetPos() \u002B angles:Forward() * dist\n    \n    local tr = util.TraceLine({start = newPos \u002B Vector(0,0,100), endpos = newPos - Vector(0,0,200), mask = MASK_SOLID_BRUSHONLY})\n    if tr.Hit then newPos = tr.HitPos \u002B Vector(0,0,5) end\n    \n    _G.ShadowFigure:SetNoDraw(true)\n    timer.Simple(0.1, function()\n        if IsValid(_G.ShadowFigure) then\n            _G.ShadowFigure:SetPos(newPos)\n            _G.ShadowFigure:SetAngles(Angle(0, (ply:GetPos() - newPos):Angle().y, 0))\n            _G.ShadowFigure:SetNoDraw(false)\n        end\n    end)\n    \n    timer.Adjust(\u0022ShadowFollow\u0022, math.Rand(3, 7), 0)\nend)\n\ntimer.Create(\u0022ShadowLookCheck\u0022, 0.1, 0, function()\n    if not _G.ShadowActive or not IsValid(_G.ShadowFigure) or not IsValid(ply) then return end\n    \n    local eyePos = ply:EyePos()\n    local eyeDir = ply:EyeAngles():Forward()\n    local toShadow = (_G.ShadowFigure:GetPos() \u002B Vector(0,0,40) - eyePos):GetNormalized()\n    local dot = eyeDir:Dot(toShadow)\n    \n    local tr = util.TraceLine({start = eyePos, endpos = _G.ShadowFigure:GetPos() \u002B Vector(0,0,40), filter = ply})\n    local canSee = (tr.Entity == _G.ShadowFigure or not tr.Hit or tr.Fraction \u003E 0.95)\n    \n    if dot \u003E 0.85 and canSee then\n        ply:TakeDamage(2, _G.ShadowFigure, _G.ShadowFigure)\n        ply:EmitSound(\u0022ambient/levels/prison/radio_random\u0022 .. math.random(1,9) .. \u0022.wav\u0022, 60, math.random(40,60))\n        \n        RunOnClient([=[\n            if not _G.ShadowDarkness then\n                _G.ShadowDarkness = 0\n            end\n            _G.ShadowDarkness = math.Clamp(_G.ShadowDarkness \u002B 15, 0, 180)\n            \n            hook.Add(\u0022HUDPaint\u0022, \u0022ShadowDarkOverlay\u0022, function()\n                if _G.ShadowDarkness and _G.ShadowDarkness \u003E 0 then\n                    surface.SetDrawColor(0, 0, 0, _G.ShadowDarkness)\n                    surface.DrawRect(0, 0, ScrW(), ScrH())\n                    _G.ShadowDarkness = _G.ShadowDarkness - 0.3\n                    \n                    if math.random(1,10) == 1 then\n                        surface.SetDrawColor(20, 0, 0, math.random(20,60))\n                        local x, y = math.random(0, ScrW()), math.random(0, ScrH())\n                        surface.DrawRect(x, y, math.random(50,200), math.random(2,8))\n                    end\n                end\n            end)\n            \n            util.ScreenShake(Vector(0,0,0), 2, 5, 0.3, 0)\n        ]=])\n    end\nend)\n\ntimer.Simple(60, function()\n    _G.ShadowActive = false\n    timer.Remove(\u0022ShadowFollow\u0022)\n    timer.Remove(\u0022ShadowLookCheck\u0022)\n    if IsValid(_G.ShadowFigure) then _G.ShadowFigure:Remove() end\n    RunOnClient([=[\n        hook.Remove(\u0022HUDPaint\u0022, \u0022ShadowDarkOverlay\u0022)\n        _G.ShadowDarkness = nil\n    ]=])\nend)",
  "UndoCode": "_G.ShadowActive = false\ntimer.Remove(\u0022ShadowFollow\u0022)\ntimer.Remove(\u0022ShadowLookCheck\u0022)\nif IsValid(_G.ShadowFigure) then _G.ShadowFigure:Remove() end\n_G.ShadowFigure = nil\nRunOnClient([=[\n    hook.Remove(\u0022HUDPaint\u0022, \u0022ShadowDarkOverlay\u0022)\n    _G.ShadowDarkness = nil\n]=])",
  "Category": "Threatening",
  "Description": null,
  "SavedAt": "2025-12-16T04:01:18.4605118Z",
  "OriginalCommandId": 265,
  "IsBuiltIn": true
}