{
  "Id": 16,
  "Name": "Press PageDown Or Die",
  "UserPrompt": "Permanent event, One in a while, big text on screen that says either \u0022PRESS PAGEDOWN OR DIE\u0022 or \u0022PRESS PAGEDOWN TO DIE\u0022 that requires the user to do one of those, the more common and first one ran in a session should always be \u0022PRESS PAGEDOWN OR DIE\u0022, we fake them out by sneaking in the \u0022TO DIE\u0022 one once in a while. The death from completing or not completing the action should just spawn an explosion ontop of the player.\n",
  "ExecutionCode": "PAGEDOWN_EVENT_COUNT = PAGEDOWN_EVENT_COUNT or 0\nPAGEDOWN_TIMER_ACTIVE = true\n\nlocal function TriggerPageDownEvent()\n    if not PAGEDOWN_TIMER_ACTIVE then return end\n    \n    PAGEDOWN_EVENT_COUNT = PAGEDOWN_EVENT_COUNT \u002B 1\n    \n    local isToDie = PAGEDOWN_EVENT_COUNT \u003E 1 and math.random(1, 5) == 1\n    local message = isToDie and \u0022PRESS PAGEDOWN TO DIE\u0022 or \u0022PRESS PAGEDOWN OR DIE\u0022\n    \n    local ply = Entity(1)\n    if not IsValid(ply) then return end\n    \n    local eventID = \u0022pagedown_event_\u0022 .. CurTime()\n    \n    ply:SetNWString(\u0022pagedown_msg\u0022, message)\n    ply:SetNWBool(\u0022pagedown_active\u0022, true)\n    ply:SetNWFloat(\u0022pagedown_endtime\u0022, CurTime() \u002B 5)\n    ply:SetNWString(\u0022pagedown_id\u0022, eventID)\n    ply:SetNWBool(\u0022pagedown_is_todie\u0022, isToDie)\n    \n    RunOnClient([=[\n        local eventID = LocalPlayer():GetNWString(\u0022pagedown_id\u0022, \u0022\u0022)\n        PAGEDOWN_PRESSED = PAGEDOWN_PRESSED or {}\n        PAGEDOWN_PRESSED[eventID] = false\n        \n        if IsValid(PAGEDOWN_PANEL) then PAGEDOWN_PANEL:Remove() end\n        \n        PAGEDOWN_PANEL = vgui.Create(\u0022DPanel\u0022)\n        PAGEDOWN_PANEL:SetSize(ScrW(), ScrH())\n        PAGEDOWN_PANEL:SetPos(0, 0)\n        PAGEDOWN_PANEL.Paint = function(self, w, h)\n            if not LocalPlayer():GetNWBool(\u0022pagedown_active\u0022, false) then return end\n            local msg = LocalPlayer():GetNWString(\u0022pagedown_msg\u0022, \u0022\u0022)\n            local timeLeft = LocalPlayer():GetNWFloat(\u0022pagedown_endtime\u0022, 0) - CurTime()\n            \n            surface.SetFont(\u0022DermaLarge\u0022)\n            local tw, th = surface.GetTextSize(msg)\n            \n            local pulse = math.abs(math.sin(CurTime() * 5)) * 55 \u002B 200\n            local bgAlpha = math.Clamp(150 - timeLeft * 20, 50, 150)\n            \n            draw.RoundedBox(8, w/2 - tw/2 - 30, h/3 - 20, tw \u002B 60, th \u002B 60, Color(0, 0, 0, bgAlpha))\n            draw.SimpleText(msg, \u0022DermaLarge\u0022, w/2, h/3, Color(255, pulse, pulse), TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)\n            draw.SimpleText(string.format(\u0022%.1f\u0022, math.max(0, timeLeft)), \u0022DermaLarge\u0022, w/2, h/3 \u002B 50, Color(255, 255, 0), TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)\n        end\n        \n        if PAGEDOWN_HOOK then hook.Remove(\u0022Think\u0022, \u0022PageDownCheck\u0022) end\n        PAGEDOWN_HOOK = true\n        hook.Add(\u0022Think\u0022, \u0022PageDownCheck\u0022, function()\n            if not LocalPlayer():GetNWBool(\u0022pagedown_active\u0022, false) then return end\n            local curEventID = LocalPlayer():GetNWString(\u0022pagedown_id\u0022, \u0022\u0022)\n            if input.IsKeyDown(KEY_PAGEDOWN) and not PAGEDOWN_PRESSED[curEventID] then\n                PAGEDOWN_PRESSED[curEventID] = true\n                RunConsoleCommand(\u0022pagedown_pressed\u0022, curEventID)\n            end\n        end)\n    ]=])\n    \n    if not PAGEDOWN_CONCOMMAND_ADDED then\n        PAGEDOWN_CONCOMMAND_ADDED = true\n        concommand.Add(\u0022pagedown_pressed\u0022, function(ply, cmd, args)\n            local sentID = args[1] or \u0022\u0022\n            local currentID = ply:GetNWString(\u0022pagedown_id\u0022, \u0022\u0022)\n            if sentID == currentID and ply:GetNWBool(\u0022pagedown_active\u0022, false) then\n                ply:SetNWBool(\u0022pagedown_pressed_server\u0022, true)\n            end\n        end)\n    end\n    \n    timer.Create(\u0022pagedown_check_\u0022 .. eventID, 5, 1, function()\n        if not IsValid(ply) then return end\n        \n        local pressed = ply:GetNWBool(\u0022pagedown_pressed_server\u0022, false)\n        local shouldDie = (isToDie and pressed) or (not isToDie and not pressed)\n        \n        if shouldDie then\n            local explode = ents.Create(\u0022env_explosion\u0022)\n            explode:SetPos(ply:GetPos() \u002B Vector(0, 0, 40))\n            explode:SetKeyValue(\u0022iMagnitude\u0022, \u0022100\u0022)\n            explode:Spawn()\n            explode:Fire(\u0022Explode\u0022, \u0022\u0022, 0)\n        end\n        \n        ply:SetNWBool(\u0022pagedown_active\u0022, false)\n        ply:SetNWBool(\u0022pagedown_pressed_server\u0022, false)\n    end)\n    \n    timer.Create(\u0022pagedown_next_event\u0022, math.random(10, 30), 1, function()\n        if PAGEDOWN_TIMER_ACTIVE then TriggerPageDownEvent() end\n    end)\nend\n\ntimer.Simple(math.random(5, 10), TriggerPageDownEvent)",
  "UndoCode": "PAGEDOWN_TIMER_ACTIVE = false\ntimer.Remove(\u0022pagedown_next_event\u0022)\nfor _, tmr in pairs(timer.GetTable()) do\n    local name = _\n    if string.StartWith(name, \u0022pagedown_check_\u0022) then\n        timer.Remove(name)\n    end\nend\nlocal ply = Entity(1)\nif IsValid(ply) then\n    ply:SetNWBool(\u0022pagedown_active\u0022, false)\nend\nRunOnClient([=[\n    if IsValid(PAGEDOWN_PANEL) then PAGEDOWN_PANEL:Remove() end\n    hook.Remove(\u0022Think\u0022, \u0022PageDownCheck\u0022)\n    PAGEDOWN_HOOK = false\n]=])",
  "Category": "Annoyances",
  "Description": null,
  "SavedAt": "2025-12-16T04:42:07.6293636Z",
  "OriginalCommandId": 295,
  "IsBuiltIn": true,
  "Variations": []
}